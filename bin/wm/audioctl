#!/bin/sh

set -eu

# ----------------------------------------------------------------------
# General
# ----------------------------------------------------------------------

SCRIPTNAME=$(basename $0)
SCRIPTDIR=$(dirname $(readlink -f $0))
# TODO: better way to grab username
USERNAME=$(echo $SCRIPTDIR | sed "s_/home/\([^/]\+\).*_\1_")
_UID="$(id -u $USERNAME)"
export DISPLAY=":0"
export XAUTHORITY=/home/$USERNAME/.Xauthority
CONFIG=/home/$USERNAME/.config/$SCRIPTNAME
CMDBASE="xrandr -d $DISPLAY"

main () {
    case ${1:-} in
        vol*) shift; volume $*  ;;
        mic*) shift; mic $*     ;;
        re*)  rescan            ;;
    esac
}

rescan () {
    pacmd unload-module module-udev-detect && pacmd load-module module-udev-detect
}

volume () {
    for i in $(seq 0 9)
    do
        case ${1:-} in
            up)     pactl set-sink-volume $i +5%  &>/dev/null || :   ;;
            down)   pactl set-sink-volume $i -5%  &>/dev/null || :   ;;
            mute)   pactl set-sink-mute $i toggle &>/dev/null || :   ;;
        esac
    done
}

mic () {
    logger ">>>>>>>>>>>> here in mic with $1"
    for i in $(seq 0 9)
    do
        case ${1:-} in
            mute)   pactl set-source-mute $i toggle &>/dev/null || :   ;;
        esac
    done
}

main $*

# vim: ft=sh:expandtab:ts=4:shiftwidth=4
